<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <title>{{ book.title }} â€“ Book Reader</title>
  <meta name="viewport" content="width=device-width, initial-scale=1" />

  <!-- Icons -->
  <link rel="stylesheet"
        href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.0/css/all.min.css"/>

  <!-- Reader CSS -->
  <link rel="stylesheet" href="{{ url_for('static', filename='css/reader.css') }}">

  <!-- PDF.js Core -->
  <script src="https://cdnjs.cloudflare.com/ajax/libs/pdf.js/2.16.105/pdf.min.js"></script>
</head>

<body>

<!-- ===============================================
     ðŸ”½ THUMBNAIL EXPAND/COLLAPSE BUTTON (GLOBAL)
================================================ -->
<button id="thumbToggle" class="thumb-toggle">
    <i class="fa fa-chevron-right"></i>
</button>

<!-- ================================
     ROOT WRAPPER
================================ -->
<div class="reader-shell">

    <!-- ================================
         LEFT SIDEBAR (THUMBNAILS)
         Starts collapsed by default
    ================================= -->
    <aside class="thumb-sidebar collapsed" id="thumbSidebar">
        <div class="thumb-scroll" id="thumbContainer"></div>
    </aside>

    <!-- ================================
         HEADER (Back Left, Title Right)
    ================================= -->
    <header class="reader-header">

        <!-- Back Button -->
        <a href="{{ url_for('home') }}" class="back-btn">
            <i class="fa fa-arrow-left"></i> Back
        </a>

        <!-- Book Title -->
        <div class="header-title">
            <div class="book-title">{{ book.title }}</div>
            <div class="book-byline">
                {% if book.author %}By {{ book.author }}{% endif %}
                {% if book.year %} â€¢ {{ book.year }}{% endif %}
            </div>
        </div>

    </header>

    <!-- ================================
         MAIN READER AREA
    ================================= -->
    <main class="reader-main">

        <section class="viewer-shell">

            <div class="book-frame">

                <!-- Spread (single or two pages) -->
                <div class="spread-shell spread--single" id="spreadShell">

                    <!-- LEFT PAGE -->
                    <div class="page-canvas-wrap page-left" id="pageWrapperLeft">
                        <canvas id="pdfCanvasLeft"></canvas>
                    </div>

                    <!-- MIDDLE SPINE -->
                    <div class="book-spine"></div>

                    <!-- RIGHT PAGE -->
                    <div class="page-canvas-wrap page-right" id="pageWrapperRight">
                        <canvas id="pdfCanvasRight"></canvas>
                    </div>

                </div><!-- spread end -->

            </div><!-- frame end -->

            <!-- ================================
                 FOOTER CONTROLS
            ================================= -->
            <div class="controls-bar">

                <button class="ctrl-btn" id="prevPageBtn" title="Previous page">
                    <i class="fa fa-chevron-left"></i>
                </button>

                <span class="page-indicator">
                    <span id="pageNumberDisplay">1</span>
                    /
                    <span id="totalPages">1</span>
                </span>

                <input type="range" id="pageSlider" min="1" max="1" value="1">

                <button class="ctrl-btn" id="nextPageBtn" title="Next page">
                    <i class="fa fa-chevron-right"></i>
                </button>

                <button class="ctrl-btn" id="toggleViewBtn" title="Toggle View">
                    <i class="fa fa-book-open"></i>
                    <span class="view-label">Two-page</span>
                </button>

            </div><!-- controls end -->

        </section>

    </main>

</div><!-- reader-shell END -->


<!-- Pass PDF URL to JS -->
<script>
    const PDF_URL = {{ pdf_url | tojson }};
</script>

<!-- Reader Logic -->
<script src="{{ url_for('static', filename='js/reader.js') }}"></script>

</body>
</html>
